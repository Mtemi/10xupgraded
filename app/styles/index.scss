@import './variables.scss';
@import './z-index.scss';
@import './animations.scss';
@import './components/terminal.scss';
@import './components/resize-handle.scss';
@import './components/code.scss';
@import './components/editor.scss';
@import './components/toast.scss';
@import './components/tradingview.scss';
@import './components/workbench.scss';
@import './components/mobile.scss';

/* Default: Fixed height for workbench */
html,
body {
  height: 100%;
  width: 100%;
  background-color: #000;
  overflow: hidden; /* Prevent body scroll when workbench is active */
}

body {
  font-family: Inter, "SF Pro Text", -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", system-ui, ui-sans-serif, sans-serif;
  line-height: 1.6;
  position: relative;
}

/* Homepage view: Allow scrolling when workbench is NOT active */
body:not(.workbench-active) {
  height: auto;
  min-height: 100%;
  overflow-x: hidden;
  overflow-y: auto;
}

html:has(body:not(.workbench-active)) {
  height: auto;
  min-height: 100%;
  overflow-x: hidden;
}

/* Headings - Bitget-like hierarchy */
h1, h2, h3, h4, h5, h6 {
  font-weight: 700;
  line-height: 1.3;
  letter-spacing: -0.01em;
}

h1 { font-size: clamp(1.875rem, 2.5vw, 2.75rem); } /* ~30-44px */
h2 { font-size: clamp(1.5rem, 2.0vw, 2.0rem); }    /* ~24-32px */
h3 { font-size: clamp(1.25rem, 1.5vw, 1.5rem); }   /* ~20-24px */
h4 { font-size: 1.125rem; }                        /* 18px */
h5 { font-size: 1rem; }                            /* 16px */
h6 { font-size: 0.875rem; }                        /* 14px */

/* Body text */
p, li, span, input, textarea, button {
  font-weight: 400;
}

/* Global Scrollbar Styling - Very thin, subtle, matches theme */
* {
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 255, 255, 0.1) transparent;
}

*::-webkit-scrollbar {
  width: 4px;
  height: 4px;
}

*::-webkit-scrollbar-track {
  background: transparent;
}

*::-webkit-scrollbar-thumb {
  background-color: rgba(255, 255, 255, 0.1);
  border-radius: 2px;
  transition: background-color 0.2s ease;
}

*::-webkit-scrollbar-thumb:hover {
  background-color: rgba(255, 255, 255, 0.2);
}

*::-webkit-scrollbar-corner {
  background: transparent;
}

/* Add styles for background image container */
.bg-image-container {
  position: absolute;
  inset: 0;
  z-index: 0;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  opacity: 0.15;
  pointer-events: none;
}

/* Add blinking cursor animation */
@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

/* Add animation for the textarea cursor */
@keyframes blink-caret {
  from, to { opacity: 1; }
  50% { opacity: 0; }
}

/* Add utility class for blinking animation */
.animate-blink {
  animation: blink-caret 1s step-end infinite;
}

/* Ensure textarea cursor is always visible and blinking */
textarea {
  caret-color: var(--bolt-elements-textPrimary);
  
  /* Mobile optimizations */
  @media (max-width: 640px) {
    font-size: 16px; /* Prevents zoom on iOS */
    line-height: 1.4;
    
    /* Prevent textarea resizing and layout shifts */
    resize: none !important;
    overflow-y: auto;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    
    /* Improve performance on mobile */
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    will-change: scroll-position;
    
    /* Prevent elastic scrolling */
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }
}

textarea:focus {
  caret-color: var(--bolt-elements-textPrimary);

  @media (max-width: 640px) {
    /* Ensure no zoom on focus for iOS */
    font-size: 16px;
    transform: translateZ(0);
  }
}

/* Chatbox placeholder styling - white checkmarks with reduced transparency */
.chatbox-placeholder {
  &::placeholder {
    color: rgba(255, 255, 255, 0.6) !important; /* white with reduced transparency */
  }
}

/* Mobile-specific improvements */
@media (max-width: 640px) {
  .mobile-textarea-optimized {
    line-height: 1.3 !important;
    padding-top: 0.75rem !important;
    padding-bottom: 0.75rem !important;

    /* Ensure placeholder text fills the textarea properly */
    &::placeholder {
      line-height: 1.3;
      padding: 0;
      margin: 0;
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow: hidden;
    }

    /* Prevent any scrolling for placeholder */
    &:placeholder-shown {
      overflow: hidden;
    }
  }

  .max-w-chat {
    max-width: calc(100vw - 1.5rem);
    margin: 0 auto;
  }

  /* Ensure proper touch targets */
  button {
    min-height: 44px;
    min-width: 44px;
  }

  /* Improve readability on small screens */
  .kbd {
    padding: 0.125rem 0.25rem;
    font-size: 0.75rem;
  }

  /* Prevent horizontal scroll on mobile */
  body {
    overflow-x: hidden;
    position: relative;
  }

  /* Ensure proper viewport handling */
  .relative {
    max-width: 100vw;
  }

  /* Optimize hero section for mobile */
  #intro {
    padding-left: 1rem;
    padding-right: 1rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;

    h1 {
      word-break: keep-all;
      hyphens: none;
      display: flex;
      justify-content: center;
      width: 100%;

      span {
        font-size: 1.125rem !important; /* 18px - smaller to ensure single line */
        line-height: 1.2 !important;
        white-space: nowrap !important;
        overflow: visible !important;
        text-overflow: unset !important;
        display: block !important;
        width: 100% !important;
        text-align: center !important;
      }
    }

    p {
      font-size: 0.625rem !important; /* 10px - very small to ensure single line */
      line-height: 1.2 !important;
      white-space: nowrap !important;
      overflow: visible !important;
      text-align: center !important;
      width: 100% !important;
      display: block !important;

      span {
        white-space: nowrap !important;
        display: inline !important;
      }
    }
  }

  /* Improve example prompts on mobile */
  #examples {
    button {
      padding: 0.75rem 0.5rem;
      line-height: 1.3;
      text-align: center;
      word-break: break-word;
      hyphens: auto;
    }
  }

  /* Optimize exchange logos for mobile */
  .exchange-logos {
    img {
      height: 0.625rem; /* 10px */
      width: auto;
    }
  }
}

/* Desktop and larger screen optimizations for hero text */
@media (min-width: 641px) {
  #intro {
    h1 {
      span {
        white-space: nowrap;
        max-width: none;
      }
    }

    p {
      span {
        white-space: nowrap;
      }
    }
  }
}

/* Ensure text stays centered and responsive across all screen sizes */
#intro {
  h1, p {
    text-align: center;
    margin-left: auto;
    margin-right: auto;
  }

  /* Prevent text from breaking on medium screens */
  @media (min-width: 768px) and (max-width: 1024px) {
    h1 span {
      font-size: clamp(2rem, 4vw, 3.5rem);
    }

    p span {
      font-size: clamp(0.75rem, 1.5vw, 0.875rem);
    }
  }
}

/* Prevent layout shifts during component mounting */
.chat-layout {
  contain: layout style;
}

/* Improve textarea performance */
.textarea-wrapper {
  contain: layout style;
  transform: translateZ(0);
}

/* -------------------------------------------------------------------------- */
/* Day 2: Design System - Buttons & Cards                                     */
/* -------------------------------------------------------------------------- */

/* Recolor raster logo via mask (uses PNG alpha as mask) */
.logo-mask {
  display: inline-block;
  -webkit-mask-image: url('/101x.png');
  mask-image: url('/101x.png');
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-position: center;
  mask-position: center;
  -webkit-mask-size: contain;
  mask-size: contain;
  background-color: theme('colors.accent.500');
}

/* Primary button (green) */
.btn-primary {
  background: linear-gradient(180deg, theme('colors.accent.400') 0%, theme('colors.accent.500') 100%);
  color: white;
  border-radius: 8px;
  padding: 0.75rem 1rem;
  font-weight: 600;
  transition: all 200ms ease;
  border: 1px solid theme('colors.alpha.accent.20');
  box-shadow: 0 6px 20px -10px theme('colors.alpha.accent.40');
}
.btn-primary:hover {
  filter: brightness(1.05);
  transform: translateY(-1px);
}
.btn-primary:active {
  filter: brightness(0.98);
  transform: translateY(0);
}
.btn-primary:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* Outline accent button */
.btn-outline-accent {
  background: transparent;
  color: theme('colors.accent.500');
  border-radius: 8px;
  padding: 0.75rem 1rem;
  font-weight: 600;
  transition: all 200ms ease;
  border: 2px solid theme('colors.alpha.accent.30');
}
.btn-outline-accent:hover {
  border-color: theme('colors.accent.500');
  background: theme('colors.alpha.accent.10');
}

/* Standard card */
.card-standard {
  background: var(--bolt-elements-bg-depth-2);
  border: 1px solid var(--bolt-elements-borderColor);
  border-radius: 12px;
  padding: 0.75rem; /* 12px on mobile */
}
@media (min-width: 640px) {
  .card-standard {
    padding: 1.25rem; /* 20px at sm+ */
  }
}
@media (min-width: 1024px) {
  .card-standard {
    padding: 1.5rem; /* 24px at lg+ */
  }
}
.card-standard:hover {
  border-color: var(--bolt-elements-borderColorActive);
  box-shadow: 0 10px 24px -12px rgba(34, 211, 238, 0.25);
}

/* -------------------------------------------------------------------------- */
/* Workbench Protection - Prevent card/button styles from affecting workbench */
/* -------------------------------------------------------------------------- */

/* Reset card/button styles inside workbench to prevent interference */
.workbench {
  .btn-primary,
  .btn-outline-accent,
  .card-standard,
  .logo-mask {
    all: revert;
  }
}